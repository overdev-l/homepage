---
title: æ•°æ®æ ‡æ³¨å¹³å°ä¸­åŸºäºFabric.jså®ç°é«˜æ•ˆå¤šè¾¹å½¢æ ‡æ³¨maskåŠŸèƒ½çš„å®Œæ•´æŒ‡å—
date: 2025-03-12
description: æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†å¦‚ä½•åœ¨æ•°æ®æ ‡æ³¨å¹³å°ä¸­åŸºäºFabric.jså®ç°é«˜æ•ˆå¤šè¾¹å½¢maskæ ‡æ³¨åŠŸèƒ½ï¼ŒåŒ…å«å®Œæ•´ä»£ç ç¤ºä¾‹ã€æ€§èƒ½ä¼˜åŒ–æŠ€å·§å’Œç”¨æˆ·ä½“éªŒè®¾è®¡ï¼ŒåŠ©åŠ›AIè®­ç»ƒæ•°æ®ç²¾å‡†æ ‡æ³¨ã€‚
---

*å…ˆçœ‹DemoğŸ‘‡ï¼š*
<FabricPolygonMask/>

## æ ¸å¿ƒåŠŸèƒ½
1. **å¤šè¾¹å½¢ç»˜åˆ¶**
   - é¼ æ ‡ç‚¹å‡»ç»˜åˆ¶é¡¶ç‚¹
   - å®æ—¶é¢„è§ˆç»˜åˆ¶è·¯å¾„
   - ç©ºæ ¼é”®æäº¤å¤šè¾¹å½¢
   - æ”¯æŒè¦†ç›–æ¨¡å¼/åˆå¹¶æ¨¡å¼åˆ‡æ¢

2. **å¤šè¾¹å½¢ç¼–è¾‘**
   - æ§åˆ¶ç‚¹æ‹–æ‹½ä¿®æ”¹å½¢çŠ¶
   - è‡ªåŠ¨ç»´æŠ¤å¤šè¾¹å½¢æ‹“æ‰‘å…³ç³»
   - æ”¯æŒå¤šå›¾å±‚å åŠ æ¸²æŸ“

3. **é«˜çº§ç‰¹æ€§**
   - å¤šè¾¹å½¢å¸ƒå°”è¿ç®—åˆå¹¶

---
æŠ€æœ¯å®ç°ä»¥æ’ä»¶æ–¹å¼å¼•å…¥åªéœ€è¦ä¼ é€’`fabric.Canvas`å®ä¾‹å³å¯
```ts
new PolygonUtil(fabricCanvas.current)
```
`polygonUtil`ä½œä¸ºæ ¸å¿ƒå·¥å…·æ’ä»¶ï¼Œåè°ƒè§†å›¾å·¥å…·å’Œå­˜å‚¨ç®¡ç†ã€‚

æ ¸å¿ƒå·¥å…·æ’ä»¶ä»¥Viewã€Stashã€Themeã€ä»¥åŠPolyboolç»„æˆï¼Œå¯¹å¤–æš´éœ²ä»¥ä¸Šæ’ä»¶çš„æ•´åˆï¼Œä½†æ˜¯ä¸ä¿å­˜ä»»ä½•çŠ¶æ€ï¼Œåªåšèšåˆèƒ½åŠ›ã€‚

Viewæ¨¡å—ç»´æŠ¤äº†åˆ›å»ºæ—¶çš„ä¸´æ—¶å¤šè¾¹å½¢çš„æ¸²æŸ“å’Œæäº¤åˆ›å»ºå®Œæˆçš„å¤šè¾¹å½¢èƒ½åŠ›ã€‚ä¸‹é¢ä»£ç æè¿°äº†ä»¥`Fabric`äº‹ä»¶é©±åŠ¨çš„å®æ—¶æ›´æ–°ä¸´æ—¶å¤šè¾¹å½¢çš„é€»è¾‘

![](https://cdn.overdev.cn/Untitled.mp4)

```ts
export class ViewTool {
    ...
    
    onMouseDown(e: TPointerEventInfo<TPointerEvent>) {
        if (!this.isEnable) return;
        const pointer = this.polygonUtil
                            .canvas
                            .getScenePoint(e.e);
        this.pointers.push(pointer);
        this.render();
    }

    onMouseMove(e: TPointerEventInfo<TPointerEvent>) {
        if (
            !this.isEnable ||
            this.pointers.length === 0
            ) return;
        this.lastPointer = this.polygonUtil
                               .canvas
                               .getScenePoint(e.e);
        this.render();
    }

    private render() {
        this.clearPreview();
        this.polygonView = new Polygon(
            [...this.pointers, this.lastPointer],
            {
            fill: this.polygonUtil
                      .theme
                      .getPolygonViewTheme().fill,
            stroke: this.polygonUtil
                        .theme
                        .getPolygonViewTheme().stroke
        });
        this.polygonView.set({ name: 'view-polygon' });
        this.polygonUtil.canvas.add(this.polygonView);
    }
}
```
---


*å‚è€ƒèµ„æºï¼š*
- [Fabric.jså®˜æ–¹æ–‡æ¡£](https://fabricjs.com)
- [Polybool.js å¤šè¾¹å½¢å¸ƒå°”è¿ç®—åº“](https://github.com/velipso/polybool)